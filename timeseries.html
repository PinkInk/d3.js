<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <script src="https://d3js.org/d3.v4.min.js"></script>
    </head>

    <body>

        <svg id="canvas"></svg>

        <script>

            width = 900;
            height = 600;

            sample_count = 20;
            sample_new = (_) => (Math.random() - 0.5) * 2
            data = Array.from(Array(sample_count)).map(sample_new);

            canvas = d3.select("#canvas")
                .attr("width", width)
                .attr("height", height);

            canvas.append("rect")
                .attr("x", 0).attr("y", 0)
                .attr("width", width).attr("height", height)
                .attr("style", "fill:none; stroke:lightgrey;");

            xscale = d3.scaleLinear()
                .domain([0, sample_count])
                .range([0, width]);

            yscale = d3.scaleLinear()
                .domain([-1, 1])
                .range([height/2+50, height/2-50]);

            line = d3.line()
                .x( (d,i) => xscale(i) )
                .y( (d) => yscale(d) );

            path = canvas.append("path")
                .datum(data)
                .attr("d", line)
                .attr("style", "stroke: black; stroke-width: 1; fill:none;")

            transtime = 150;

            // d3.interval( // wiggle
            //     function() {
            //         data.push(sample_new());
            //         data.shift();
            //         path.transition().attr("d", line) // recalc for new data
            //     },
            //     transtime
            // );


            d3.interval( // smooth
                function() {
                    data.push(sample_new());
                    path.attr("d", line(data))
                        .attr("transform", null)
                        .transition()
                            .attr("transform", "translate(" + xscale(-1) + ")")
                            .duration(transtime)
                            // .ease("linear");
                    data.shift();
                },
                transtime
            );






        </script>

    </body>

</html>